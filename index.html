<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∞–∫–∞–¥–µ–º–∏–∏</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:Arial,sans-serif;
            background:linear-gradient(135deg,#2c5f2d 0,#1a3c1a 100%);
            color:#fff;min-height:100vh;display:flex;
            justify-content:center;align-items:center;padding:20px
        }
        .container{
            background:rgba(255,255,255,.15);
            backdrop-filter:blur(15px);border-radius:25px;padding:40px;
            max-width:900px;width:100%;box-shadow:0 25px 50px rgba(0,0,0,.4);
            border:3px solid rgba(255,204,0,.3)
        }
        .screen{display:none}
        .screen.active{display:block}
        .header{text-align:center;margin-bottom:30px}
        .logo{
            font-size:3em;background:linear-gradient(45deg,#ffcc00,#ff6600);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            margin-bottom:15px;text-shadow:0 0 20px rgba(255,204,0,.5)
        }
        .name-input input{
            width:100%;max-width:400px;padding:18px 25px;font-size:1.3em;
            border:3px solid rgba(255,255,255,.3);border-radius:30px;
            background:rgba(255,255,255,.1);color:#fff;text-align:center;
            margin-bottom:25px
        }
        .name-input input::placeholder{color:rgba(255,255,255,.6)}
        .btn{
            padding:18px 40px;border:none;border-radius:30px;font-size:1.2em;
            font-weight:700;cursor:pointer;transition:.3s;width:100%;margin-bottom:15px
        }
        .start-btn{background:linear-gradient(45deg,#ff6600,#ffcc00);color:#fff}
        .start-btn:hover{transform:scale(1.05);box-shadow:0 10px 25px rgba(255,102,0,.4)}
        .progress{
            background:rgba(255,255,255,.2);height:10px;border-radius:5px;
            margin:25px 0;overflow:hidden
        }
        .progress-bar{
            height:100%;background:linear-gradient(90deg,#ffcc00,#ff6600,#00cc00);
            width:0;transition:.4s
        }
        .question{
            background:rgba(255,255,255,.08);padding:30px;border-radius:20px;
            margin-bottom:25px;border-left:6px solid #ffcc00;
            box-shadow:inset 0 2px 10px rgba(0,0,0,.2)
        }
        .question-text{font-size:1.4em;margin-bottom:25px;font-weight:700}
        .options{display:flex;flex-direction:column;gap:15px}
        .option{
            padding:20px 25px;border-radius:15px;cursor:pointer;
            transition:.3s;background:rgba(255,255,255,.1);
            border:2px solid transparent;font-size:1.1em
        }
        .option:hover{
            background:rgba(255,255,255,.25);transform:translateX(8px);
            box-shadow:0 5px 15px rgba(0,0,0,.2)
        }
        .option.selected{
            background:linear-gradient(45deg,#ffcc00,#ff6600)!important;
            color:#1a1a1a!important;border-color:#fff!important;font-weight:700
        }
        .nav-buttons{display:flex;gap:20px;margin-top:30px}
        .btn-prev{background:#666;color:#fff}
        .btn-next{background:linear-gradient(45deg,#00cc00,#66ff66);color:#1a3c1a}
        .btn:disabled{opacity:.5;cursor:not-allowed}
        .result{text-align:center}
        .rank{
            font-size:2.2em;margin:30px 0;padding:25px;border-radius:20px;
            font-weight:700;box-shadow:0 10px 30px rgba(0,0,0,.3)
        }
        .genin{background:linear-gradient(45deg,#00cc00,#66ff66);color:#1a3c1a}
        .chunin{background:linear-gradient(45deg,#0066cc,#66ccff);color:#003366}
        @media(max-width:768px){.nav-buttons{flex-direction:column}}
    </style>
</head>
<body>
<div class="container">

    <div id="nameScreen" class="screen active">
        <div class="header">
            <div class="logo">üçÉ Êú®„ÉéËëâÈö†„Çå„ÅÆÈáå</div>
            <h1>‚öîÔ∏è –ê–∫–∞–¥–µ–º–∏—è —à–∏–Ω–æ–±–∏ ‚öîÔ∏è</h1>
            <h2>–≠–∫–∑–∞–º–µ–Ω –ø–æ –∑–Ω–∞–Ω–∏—é –∑–∞–∫–æ–Ω–æ–≤ –¥–µ—Ä–µ–≤–Ω–∏ –ª–∏—Å—Ç–∞</h2>
        </div>
        <div class="name-input">
            <input type="text" id="studentName" placeholder="–í–≤–µ–¥–∏ —Å–≤–æ–π –±–æ–µ–≤–æ–π –Ω–∏–∫, —à–∏–Ω–æ–±–∏..." maxlength="20">
        </div>
        <button class="btn start-btn" type="button" onclick="startTest()">–ù–∞—á–∞—Ç—å —ç–∫–∑–∞–º–µ–Ω</button>
    </div>

    <div id="quizContainer" class="screen">
        <div class="header">
            <div class="logo">üìú –≠–∫–∑–∞–º–µ–Ω</div>
            <h2 id="studentInfo"></h2>
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
        <div id="quiz"></div>
        <div class="nav-buttons">
            <button class="btn btn-prev" type="button" onclick="prevQuestion()" id="prevBtn" disabled>‚Üê –ù–∞–∑–∞–¥</button>
            <button class="btn btn-next" type="button" onclick="nextQuestion()" id="nextBtn">–î–∞–ª–µ–µ ‚Üí</button>
        </div>
    </div>

    <div id="resultScreen" class="screen">
        <div class="header">
            <div class="logo">üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç</div>
        </div>
        <div class="result">
            <div id="score"></div>
            <div id="rank" class="rank"></div>
            <div id="feedback"></div>
        </div>
    </div>
</div>

<script>
const API_URL='https://sheetdb.io/api/v1/4ssoqxhf0fnia';

// 15 –∑–∞–≥–æ—Ç–æ–≤–æ–∫, –∑–∞–ø–æ–ª–Ω–∏ —Å–≤–æ–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
const questions=[
    {question:"–í–æ–ø—Ä–æ—Å 1",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 2",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 3",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 4",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 5",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 6",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 7",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 8",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 9",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 10",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 11",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 12",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 13",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 14",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0},
    {question:"–í–æ–ø—Ä–æ—Å 15",options:["–û—Ç–≤–µ—Ç 1","–û—Ç–≤–µ—Ç 2","–û—Ç–≤–µ—Ç 3","–û—Ç–≤–µ—Ç 4"],correct:0}
];

let currentQuestion=0;
let answers=[];
let score=0;
let studentName='';

async function alreadyPassed(name){
    const res=await fetch(`${API_URL}/search?name=${encodeURIComponent(name)}`);
    const data=await res.json();
    return data.length>0;
}

async function startTest(){
    studentName=document.getElementById('studentName').value.trim();
    if(!studentName){alert('–í–≤–µ–¥–∏ –Ω–∏–∫.');return;}

    if(await alreadyPassed(studentName)){
        alert('–≠—Ç–æ—Ç —à–∏–Ω–æ–±–∏ —É–∂–µ –ø—Ä–æ—Ö–æ–¥–∏–ª —ç–∫–∑–∞–º–µ–Ω –∏ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –µ–≥–æ —Å–Ω–æ–≤–∞.');
        return;
    }

    document.getElementById('nameScreen').classList.remove('active');
    document.getElementById('quizContainer').classList.add('active');
    document.getElementById('studentInfo').textContent='–®–∏–Ω–æ–±–∏: '+studentName;
    showQuestion();
    updateNav();
}

function showQuestion(){
    const q=questions[currentQuestion];
    document.getElementById('quiz').innerHTML=
        `<div class="question">
           <div class="question-text">Q${currentQuestion+1}: ${q.question}</div>
           <div class="options">
             ${q.options.map((opt,i)=>`<div class="option" onclick="selectOption(${i})">${opt}</div>`).join('')}
           </div>
         </div>`;
    if(answers[currentQuestion]!==undefined){
        document.querySelectorAll('.option')[answers[currentQuestion]].classList.add('selected');
    }
}

function selectOption(index){
    document.querySelectorAll('.option').forEach((o,i)=>o.classList.toggle('selected',i===index));
    answers[currentQuestion]=index;
}

function nextQuestion(){
    if(answers[currentQuestion]===undefined){alert('–í—ã–±–µ—Ä–∏ –æ—Ç–≤–µ—Ç.');return;}
    if(currentQuestion<questions.length-1){
        currentQuestion++;
        showQuestion();
        updateNav();
    }else{
        calculateScore();
    }
}

function prevQuestion(){
    if(currentQuestion>0){
        currentQuestion--;
        showQuestion();
        updateNav();
    }
}

function updateNav(){
    document.getElementById('prevBtn').disabled=currentQuestion===0;
    document.getElementById('nextBtn').textContent=
        currentQuestion===questions.length-1?'–ó–∞–≤–µ—Ä—à–∏—Ç—å ‚Üí':'–î–∞–ª–µ–µ ‚Üí';
    updateProgress();
}

function updateProgress(){
    document.getElementById('progressBar').style.width=
        ((currentQuestion+1)/questions.length*100)+'%';
}

async function calculateScore(){
    // –∑–¥–µ—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª
    score=answers.filter((ans,i)=>ans===questions[i].correct).length;
    const errors=questions.length-score;
    const passed=errors<=7;
    const status=passed?'–ü—Ä–æ—à—ë–ª':'–ù–µ –ø—Ä–æ—à—ë–ª';
    const dateStr=new Date().toLocaleString('ru-RU');

    // –∑–¥–µ—Å—å –ø–æ–ª–µ score —É—Ö–æ–¥–∏—Ç –≤ Google-—Ç–∞–±–ª–∏—Ü—É
    await fetch(API_URL,{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify([{
            name:studentName,
            score:score,
            date:dateStr,
            status:status
        }])
    });

    showResult(status,errors);
}

function showResult(status,errors){
    document.getElementById('quizContainer').classList.remove('active');
    document.getElementById('resultScreen').classList.add('active');

    document.getElementById('score').innerHTML=
        `<h2>–ë–∞–ª–ª—ã: ${score} –∏–∑ ${questions.length} ‚Äî –æ—à–∏–±–æ–∫: ${errors}</h2>`;
    document.getElementById('rank').textContent=status;
    document.getElementById('rank').className='rank '+(status==='–ü—Ä–æ—à—ë–ª'?'chunin':'genin');
    document.getElementById('feedback').innerHTML=
        status==='–ü—Ä–æ—à—ë–ª'
        ?'<p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –≠–∫–∑–∞–º–µ–Ω —Å–¥–∞–Ω.</p>'
        :'<p>–≠–∫–∑–∞–º–µ–Ω –Ω–µ —Å–¥–∞–Ω. –û–±—Ä–∞—Ç–∏—Å—å –∫ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫—É.</p>';
}
</script>
</body>
</html>


